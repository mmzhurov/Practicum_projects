**ПРОЕКТ: Отток клиентов**

**Описание проекта:**

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.
Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.
Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.
Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

**Описание данных:**

Признаки
- RowNumber — индекс строки в данных
- CustomerId — уникальный идентификатор клиента
- Surname — фамилия
- CreditScore — кредитный рейтинг
- Geography — страна проживания
- Gender — пол
- Age — возраст
- Tenure — сколько лет человек является клиентом банка
- Balance — баланс на счёте
- NumOfProducts — количество продуктов банка, используемых клиентом
- HasCrCard — наличие кредитной карты
- IsActiveMember — активность клиента
- EstimatedSalary — предполагаемая зарплата

Целевой признак
- Exited — факт ухода клиента

**Общий вывод:**

1. Подготовка данных:
- файл содержит 10 000 строк об уникальных клиентах банка (все `CustomerId` разные) с данными о них в 14 столбцах;
- столбец `Tenure` содержал 9.1% пустых ячеек, потерянные данные восстановить не смогли - ячейки заполнили значением "unknown";
- столбцы `RowNumber`, `CustomerId`, `Surname` удалили из обучающего набора данных, осталось 7 столбцов категорийного и 4 числового (`CreditScore`, `Age`, `Balance`, `EstimatedSalary`) типов;
- Pairplot не показал каких-либо сильных корреляций между признаками (мультиколлениарности нет). Наибольшее влияние на выбытие клиентов из банка (признак `Exited`) оказывают признаки `Age` и `Balance` (положительная зависимость), `IsActiveMember` и `NumOfProducts` (отрицательная корреляция);
- провели подготовку признаков:
 - преобразовали категориальные признаки в фиктивные переменные техникой прямого кодирования (OHE);
 - исходные данные разделили на обучающую, валидационную и тестовую выборки в соотношении 3:1:1 с применением перемешивания и стратификации;
 - провели масштабирование количественных признаков методом стандартизации данных.
2. Исследование задачи:
- по целевому признаку наблюдается существенный дисбаланс классов, их соотношение 4:1;
- без учета дисбаланса по различным гипперпараметрам подобрали модели 3 видов с лучшей долей правильных ответов;
- модель на основе алгоритма "Решающее дерево" при accuracy 0.837 показала лучшее значение F1-меры 0.546.
3. Борьба с дисбалансом:
- использовали 3 способа: взвешивание классов, увеличение и уменьшение выборок. Наилучшие результаты получили при увеличении выборки;
- модель с лучшими параметрами получили с помощью алгоритма "Случайный лес" (accuracy = 0.819, f1-мера = 0.618);
- с помощью изменения порога классификации увидели, что лучшая производительность модели достигается при пороге классификации 0.5;
- построили ROC-кривую модели, площадь под ROC-кривой равна 0.852, что существенно лучше, чем у случайной модели.
4. Тестирование модели прошло успешно:
- на тестовой выборке модель показала accuracy = 0.845, что лучше, чем на валидации (0.819), f1-мера тоже стала лучше - 0.649 против 0.618.
